{"version":3,"sources":["assets/dotmenu.svg","eventManage/APITypes.js","eventManage/CanvasEvent.js","board.js","WorkTable.js","serviceWorker.js","index.js"],"names":["module","exports","holdKeys","spaceKey","actions","moveBoard","scale","this","canvas","on","e","upperCanvasEl","classList","remove","add","triggerEvent","APITypes","ctxMenu","hide","delta","fabric","Point","movementX","movementY","relativePan","target","_cardId","getObjects","set","renderAll","wrapperEl","addEventListener","preventDefault","ctrlKey","deltaY","Math","min","max","zoomPoint","pageX","pLeft","pageY","pTop","zoomToPoint","passive","capture","activeObject","pointer","getPointer","objects","i","length","object","containsPoint","console","log","show","clientX","clientY","window","viewWidth","offsetWidth","viewHeight","offsetHeight","setWidth","setHeight","document","keyCode","Board","svgSources","require","cacheSvg","parentNode","offsetLeft","offsetTop","width","height","Canvas","selection","LISTAREA","CARDSIZE","events","injectCss","loadSvgs","initGlobalEvents","createSomething","createCtxMenu","cb","ks","Object","keys","forEach","key","loadSVGFromURL","options","util","groupSVGElements","style","createElement","str","type","styleSheet","cssText","innerHTML","getElementsByTagName","appendChild","opt","index","fontFamily","card","Rect","top","left","rx","ry","fill","color","shadow","offsetX","offsetY","blur","text","Textbox","fontSize","splitByGrapheme","num","group","Group","subTargetCheck","hasControls","hasBorders","dotmenu","clone","originX","originY","menuBtn","btnG","hoverCursor","item","addCard","d","isShow","className","_show","body","x","y","visibility","ev","data","fn","call","push","CanvasEvent","WorkTable","state","zoom","dragPan","_b","setState","parseInt","ref","Component","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.c2a019e7.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/dotmenu.bbc00c0c.svg\";","export default {\n  ZOOM: 'zoom',\n  DRAGPANSTART: 'dragPanStart',\n  DRAGPANEND: 'dragPanEnd',\n}","import { fabric } from \"fabric\";\nimport APITypes from './APITypes';\n\nexport default function () {\n  //鼠标按下\n  let holdKeys = {\n    spaceKey: false,\n  }\n  let actions = {\n    moveBoard: false\n  }\n  let scale = 1;\n  this.canvas.on('mouse:down', e => {\n    // const pointer = this.canvas.getPointer(e);\n    if (holdKeys.spaceKey) {\n        actions.moveBoard = 1;\n        this.canvas.upperCanvasEl.classList.remove('canvas-move');\n        this.canvas.upperCanvasEl.classList.add('canvas-moved');\n        this.triggerEvent(APITypes.DRAGPANSTART);\n    }\n    this.ctxMenu.hide()\n  });\n\n  this.canvas.on('mouse:up', e => {\n    if (actions.moveBoard && holdKeys.spaceKey) {\n        this.triggerEvent(APITypes.DRAGPANEND);\n        this.canvas.upperCanvasEl.classList.remove('canvas-move');\n        this.canvas.upperCanvasEl.classList.remove('canvas-moved');\n        actions.moveBoard = 0;\n    }\n  });\n  this.canvas.on('mouse:move', e => {\n    if (actions.moveBoard && e && e.e) {\n        var delta = new fabric.Point(e.e.movementX, e.e.movementY);\n        this.canvas.relativePan(delta);\n    }\n  });\n  this.canvas.on('mouse:over', e => {\n    if (e.target) {\n        if (e.target._cardId) {\n            e.target.getObjects()[0].set(\"shadow\", \"1px 10px 10px rgba(0,0,0,.3)\");\n            this.canvas.renderAll();\n        }\n    }\n  });\n\n  this.canvas.on('mouse:out', e => {\n    if (e.target) {\n        if (e.target._cardId) {\n            e.target.getObjects()[0].set(\"shadow\", \"1px 10px 10px rgba(0,0,0,.2)\");\n            this.canvas.renderAll();\n        }\n    }\n  });\n\n  this.canvas.wrapperEl.addEventListener('wheel', e => {\n    e.preventDefault();\n    if (e.ctrlKey) {\n        scale -= e.deltaY * 0.02;\n        scale = Math.min(scale, 10);\n        scale = Math.max(scale, 0.2);\n        var zoomPoint = new fabric.Point(e.pageX - this.pLeft, e.pageY - this.pTop);\n        this.canvas.zoomToPoint(zoomPoint, scale);\n        this.triggerEvent(APITypes.ZOOM, scale);\n    }\n    \n  }, { passive: false, capture: false, });\n  this.canvas.upperCanvasEl.addEventListener('contextmenu', e => {\n    const pointer = this.canvas.getPointer(e);\n    const objects = this.canvas.getObjects();\n    let activeObject;\n    for (let i = objects.length - 1; i >= 0; i--) {\n        let object = objects[i];\n        //判断该对象是否在鼠标点击处\n        // console.log(this.canvas.isTargetTransparent(object, pointer.x, pointer.y))\n        if (object.containsPoint(pointer)) {\n            //选中该对象\n            activeObject = object;\n            break;\n            // this.canvas.setActiveObject(object);\n        }\n    }\n    console.log(activeObject);\n    this.ctxMenu.show(e.clientX, e.clientY); // pointer 是画布的坐标，有可能缩放移动过的\n    e.preventDefault();\n    return false;\n  }, !1)\n  //.contextmenu(onContextmenu);\n  window.addEventListener('resize', () => {\n    this.viewWidth = this.canvas.wrapperEl.offsetWidth;\n    this.viewHeight = this.canvas.wrapperEl.offsetHeight;\n    this.canvas.setWidth(this.viewWidth);\n    this.canvas.setHeight(this.viewHeight);\n  }, !1);\n  document.addEventListener('keydown', e => {\n    if (e.keyCode === 32) {\n        holdKeys.spaceKey = 1;\n        this.canvas.upperCanvasEl.classList.add('canvas-move')\n    }\n  }, !1)\n  document.addEventListener('keyup', e => {\n    if (e.keyCode === 32) {\n        holdKeys.spaceKey = 0;\n        this.canvas.upperCanvasEl.classList.remove('canvas-move');\n        this.canvas.upperCanvasEl.classList.remove('canvas-moved')\n        if (actions.moveBoard) {\n            this.triggerEvent(APITypes.DRAGPANEND);\n            actions.moveBoard = 0;\n        }\n    }\n  }, !1)\n}","/*\n * @Author: DT\n * @Description: ...\n * @Date: 2020-09-18 13:26:32\n * @LastEditTime: 2020-09-28 11:35:01\n */\n\n // 先随便写下功能\nimport { fabric } from \"fabric\";\nimport { CanvasEvent } from './eventManage';\n\nclass Board {\n    constructor (canvas) {\n        this.pLeft = canvas.parentNode.offsetLeft;\n        this.pTop = canvas.parentNode.offsetTop;\n        canvas.width = this.viewWidth = canvas.parentNode.offsetWidth;\n        canvas.height = this.viewHeight = canvas.parentNode.offsetHeight;\n        this.canvas = new fabric.Canvas(canvas);\n        this.canvas.selection = false;\n        this.LISTAREA = [50, 250, 700, 700];\n        this.CARDSIZE = [180, 180];\n        this.events = {};\n        this.injectCss();\n        // obj.selectable = false  禁止拖拽\n        this.loadSvgs(() => {\n            this.initGlobalEvents();\n            this.createSomething();\n            this.createCtxMenu();\n        });\n    }\n    svgSources = {\n        \"dotmenu\": require('./assets/dotmenu.svg'),\n    }\n    cacheSvg = {}\n    loadSvgs (cb) {\n        let ks = Object.keys(this.svgSources);\n        let i = 0;\n        ks.forEach(key => {\n            fabric.loadSVGFromURL(this.svgSources[key], (objects, options) => {\n                this.cacheSvg[key] = fabric.util.groupSVGElements(objects, options);\n                this.cacheSvg[key].scale(0.02)\n                if (++i === ks.length) {\n                    cb && cb()\n                }\n            })\n        })\n    }\n    injectCss () {\n        let style = document.createElement('style'),   \n        str = `\n            .ctx-menu{\n                position: absolute;\n                width: 100px;\n                background-color: #f5f5f5;\n                border-radius: 4px;\n                visibility: hidden;\n                overflow: hidden;\n                box-shadow: 1px 4px 10px rgba(0,0,0,.2);\n            }\n            .ctx-menu span{\n                display: flex;\n                align-items: center;\n                padding: 0 10px;\n                height: 35px;\n                cursor: pointer;\n                color: #444;\n            }\n            .ctx-menu span:hover{\n                background-color: #eee;\n            }\n        `;  \n        style.type=\"text/css\";  \n        if(style.styleSheet){\n            style.styleSheet.cssText = str;  \n        } else {  \n            style.innerHTML = str;\n        }  \n        document.getElementsByTagName(\"head\")[0].appendChild(style);  \n    }\n    addCard (opt, index) {\n        // { text, num, color }\n        let fontFamily = '-apple-system,BlinkMacSystemFont,Segoe UI,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol';\n        let card = new fabric.Rect({\n            top: 0, \n            left: 0, \n            width: this.CARDSIZE[0], \n            height: this.CARDSIZE[1], \n            rx: 4, \n            ry: 4, \n            fill: opt.color,\n            shadow: {\n                color: 'rgba(0,0,0,.2)',\n                offsetX: 1,\n                offsetY: 10,\n                blur: 10\n            }\n        });\n        let text = new fabric.Textbox(opt.text, {\n            left: 10,\n            top: 35,\n            width: this.CARDSIZE[0] - 10,\n            fontSize: 16,\n            fill: '#333',\n            fontFamily,\n            splitByGrapheme: true,\n          });\n          let num = new fabric.Textbox(opt.num, {\n            left: 10,\n            top: 10,\n            width: 20,\n            fontSize: 14,\n            fontFamily,\n            fill: 'rgba(0,0,0,.7)',\n            splitByGrapheme: true,\n          });\n        //进行组合\n        let group = new fabric.Group([card, text, num], {\n            _cardId: '1243',\n            top: this.LISTAREA[1], \n            left: this.LISTAREA[0] + (this.CARDSIZE[0] + 20) * index, \n            width: this.CARDSIZE[0],\n            height: this.CARDSIZE[1],\n            subTargetCheck: true,\n            hasControls: false,\n            hasBorders: false,\n        })\n        this.cacheSvg.dotmenu.clone(clone => {\n            clone.set({\n                left: 10,\n                top: 8,\n                originX: 'left',\n                originY: 'top',\n            });\n            let menuBtn = new fabric.Rect({\n                top: 0, \n                left: 0, \n                width: 35, \n                height: 20, \n                originX: 'left',\n                originY: 'top',\n                rx: 4, \n                ry: 4, \n                fill: \"rgba(0,0,0,0)\",\n            });\n            let btnG = new fabric.Group([menuBtn, clone], {\n                top:  -this.CARDSIZE[1]/2, \n                left: this.CARDSIZE[0] - 35 - this.CARDSIZE[0]/2, \n                width: 35,\n                height: 20,\n                subTargetCheck: true,\n                hasControls: false,\n                hasBorders: false,\n            })\n            btnG.on('mouseover', function (e){\n                e.target.getObjects()[0].set(\"fill\", \"rgba(0,0,0,.1)\");\n                this.canvas.hoverCursor = 'pointer';\n                this.canvas.renderAll();\n            });\n            btnG.on('mouseout', function (e){\n                e.target.getObjects()[0].set(\"fill\", \"rgba(0,0,0,0)\");\n                this.canvas.hoverCursor = 'default';\n                this.canvas.renderAll();\n            });\n            group.add(btnG)\n        })\n        // card.on('mouseover', function (e){\n        //     console.log(e)\n        //     console.log(e.subTargets);\n        // });\n        // card.on('mouseout', function (e){\n        //     console.log(e)\n        //     console.log(e.subTargets);\n        // });\n        this.canvas.add(group);\n    }\n    createSomething () {\n        [{ color: '#FF9E4A', num: \"1\", text: \"公司机密文件容易轻易泄露，缺乏监管\" },\n        { color: '#B486BC', num: \"2\", text: \"时间变得琐碎不集中\" },\n        { color: '#F16F81', num: \"3\", text: \"这是一个神奇的卡片\\n它可以表达大家的想法\" }]\n            .forEach((item, index) => {\n                this.addCard(item, index)\n            })\n    }\n    createCtxMenu () {\n        let d = document.createElement('div');\n        let isShow = false;\n        d.className = 'ctx-menu';\n        d._show = false;\n        d.innerHTML = '<span>菜单一</span><span>菜单二</span><span>菜单三</span>';\n        document.body.appendChild(d);\n        this.ctxMenu = {\n            show: (x, y) => {\n                isShow = true;\n                d.style.left = x + 'px';\n                d.style.top = y + 'px';\n                d.style.visibility = 'visible';\n            },\n            hide: () => {\n                if (isShow) {\n                    isShow = false;\n                    d.style.visibility = 'hidden';\n                }\n            },\n            isShow: () => {\n                return isShow;\n            }\n        }\n    }\n    triggerEvent (ev, data) {\n        if (this.events[ev]) {\n            this.events[ev].forEach(fn => {\n                fn.call(this, data);\n            })\n        }\n    }\n    on (ev, fn) {\n        if (this.events[ev]) {\n            this.events[ev].push(fn);\n        } else {\n            this.events[ev] = [fn];\n        }\n    }\n    initGlobalEvents () {\n        CanvasEvent.call(this);\n    }\n}\n\nexport default Board","/*\n * @Author: DT\n * @Description: ...\n * @Date: 2020-09-18 11:21:55\n * @LastEditTime: 2020-09-22 20:03:53\n */\nimport React, { Component } from 'react';\nimport './main.css';\nimport Board from './board';\n\nclass WorkTable extends Component {\n  state = {\n    zoom: 1,\n    dragPan: false,\n  }\n  componentDidMount () {\n    this._b = new Board(this.canvas);\n    this._b.on('zoom', zoom => {\n      this.setState({ zoom })\n    })\n    this._b.on('dragPanStart', () => {\n      this.setState({ dragPan: true })\n    })\n    this._b.on('dragPanEnd', () => {\n      this.setState({ dragPan: false })\n    })\n  }\n  render () {\n    return (\n      <div className=\"main\">\n        <div className=\"tools\">\n          <p>1. 按住空格键拖拽画布<br/>2. macOS触摸板手势缩放画布<br/>3. windows系统按着ctrl键鼠标滚轮缩放画布</p>\n          <span>zoom: {parseInt(this.state.zoom*100)}%</span>\n          <span>canvas dragging: {this.state.dragPan?'yes':'no'}</span>\n        </div>\n        <canvas className=\"canvas\" ref={e => (this.canvas = e)}></canvas>\n      </div>\n    );\n  }\n}\nexport default WorkTable;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","/*\n * @Author: DT\n * @Description: ...\n * @Date: 2020-09-18 11:21:55\n * @LastEditTime: 2020-09-18 13:19:55\n */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport WorkTable from './WorkTable';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <WorkTable />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}